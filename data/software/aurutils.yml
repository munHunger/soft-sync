name: "aurutils package helper"
# dependencies:
#   - user
settings: &settings
  - path: /etc/pacman.d/aurpkgs
    content: |-
      [options]
      CacheDir = /var/cache/pacman/pkg
      CacheDir = /var/cache/pacman/aurpkgs
      CleanMethod = KeepCurrent

      [aurpkgs]
      SigLevel = Optional TrustAll
      Server = file:///var/cache/pacman/aurpkgs
  - path: /etc/pacman.conf
    content: |-
      /etc/pacman.d/aurpkgs
    position:
      type: NON_MANAGED_END
install:
  - |-
    cd /tmp
    git clone https://aur.archlinux.org/aurutils.git
    cd aurutils
    chown -R munhunger ./
    makepkg -sir --noconfirm --skippgpcheck
  - *settings
  - |-
    mkdir -p /var/cache/pacman/aurpkgs
    install -d /var/cache/pacman/aurpkgs -o $USER
    sudo repo-add /var/cache/pacman/aurpkgs/aurpkgs.db.tar
uninstall:
  - |-
    sudo pacman -R aur
  - *settings
